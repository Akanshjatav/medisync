<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>MediSync – Reset Password</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
        
    /* =========================================
      MediSync – Reset Password (Pharmacy Theme)
      Internal CSS
      ========================================= */

    /* ---------- Theme Variables ---------- */
    :root {
      --forest-deep: #102716;
      --sage-green: #4A644D;
      --warm-amber: #DE6D20;
      --near-black: #111111;
      --medium-gray: #515151;
      --light-gray: #E5E5E5;
      --white: #FFFFFF;
      --very-light-green: #f5fbf7;
      --logo-blue: #337AB7;
      --logo-green: #5CB85C;

      --forest-tint: #2A3F2C;
      --sage-shade: #3B513E;
      --amber-tint: #F4A64A;
      --amber-shade: #B85A18;
      --balanced-gray: #A0A0A0;
      --off-white: #FAFAF8;
      --green-wash: #e8f7ee;

      --burgundy: #6B1F1F;
      --navy-blue: #1F3A4D;

      --text: var(--near-black);
      --muted-text: var(--medium-gray);
      --border: var(--light-gray);

      --shadow-sm: 0 1px 2px rgba(31,58,77,0.10);
      --shadow-md: 0 4px 14px rgba(31,58,77,0.14);

      --radius-sm: 8px;
      --radius-md: 12px;
      --radius-lg: 16px;

      --space-2: 8px;
      --space-3: 12px;
      --space-4: 16px;
      --space-5: 20px;
      --space-6: 24px;
      --space-8: 32px;

      --max-content: 720px; /* focused form width */
    }

    /* ---------- Base ---------- */
    *,
    *::before,
    *::after { box-sizing: border-box; }
    html { -webkit-text-size-adjust: 100%; }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif;
      color: var(--text);
      background: linear-gradient(180deg, var(--off-white), var(--very-light-green));
      line-height: 1.5;
    }
    a { color: var(--logo-blue); text-decoration: none; }
    a:hover { text-decoration: underline; }
    h1,h2,h3 { margin: 0 0 var(--space-3); font-weight: 600; }
    ul { margin: 0; padding: 0; list-style: none; }

    /* Screen-reader only */
    .sr-only {
      position: absolute !important;
      width: 1px; height: 1px;
      padding: 0; margin: -1px;
      overflow: hidden; clip: rect(0 0 0 0);
      border: 0;
    }

    /* Focus visibility */
    :focus-visible { outline: 3px solid var(--amber-tint); outline-offset: 3px; }

    /* ---------- App Shell ---------- */
    .app {
      min-height: 100vh;
      display: grid;
      grid-template-rows: auto 1fr auto;
    }

    /* Header (consistent with dashboard) */
    .app-header {
      background:
        radial-gradient(1200px 300px at 0% 0%, rgba(218, 247, 227, 0.15), transparent 60%),
        linear-gradient(90deg, var(--navy-blue), var(--forest-tint));
      color: var(--white);
      box-shadow: var(--shadow-md);
    }
    .brand {
      display: flex; align-items: baseline; gap: var(--space-3);
      padding: var(--space-6) var(--space-8);
    }
    .brand__title { font-size: 1.6rem; letter-spacing: .4px; }
    .brand__subtitle { color: #CFE5F6; font-size: .95rem; }

    /* ---------- Layout ---------- */
    .layout {
      display: grid;
      grid-template-columns: 1fr;
      gap: var(--space-8);
      padding: var(--space-8);
      max-width: var(--max-content);
      margin: 0 auto;
    }
    .content { display: grid; gap: var(--space-8); align-content: start; }

    /* ---------- Panels ---------- */
    .panel {
      background: var(--white);
      border: 1px solid var(--border);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-sm);
      padding: var(--space-6);
    }
    .panel__title {
      color: var(--navy-blue);
      font-size: 1.25rem;
      margin-bottom: var(--space-2);
      position: relative;
      padding-left: 12px;
    }
    .panel__title::before {
      content: "";
      position: absolute;
      width: 6px; height: 22px;
      background: linear-gradient(180deg, var(--logo-blue), var(--logo-green));
      border-radius: 4px; left: 0; top: 2px;
    }
    .panel__description { color: var(--muted-text); margin-bottom: var(--space-6); }

    /* ---------- Form Fields ---------- */
    .form-field {
      display: grid;
      gap: var(--space-2);
      margin-bottom: var(--space-5);
    }
    .form-field__label {
      color: var(--near-black);
      font-weight: 600;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }
    .form-field__help { color: var(--muted-text); font-size: .9rem; }

    .form-field__input {
      width: 100%;
      padding: 10px 12px;
      border: 1px solid #dfe5ea;
      border-radius: var(--radius-sm);
      background: #fafcff;
      color: var(--near-black);
      box-shadow: inset 0 1px 2px rgba(31,58,77,0.06);
      transition: border-color 140ms ease, box-shadow 140ms ease, background 140ms ease;
    }
    .form-field__input::placeholder { color: var(--balanced-gray); }
    .form-field__input:focus {
      border-color: var(--logo-blue);
      box-shadow: 0 0 0 3px rgba(51,122,183,0.18);
      background: #fff;
    }

    /* Password field extras */
    .password-field { position: relative; }
    .info-btn {
      display: inline-flex; align-items: center; justify-content: center;
      width: 22px; height: 22px; border-radius: 50%;
      font-size: .85rem; font-weight: 700;
      background: #ecf5ff; color: var(--navy-blue);
      border: 1px solid var(--logo-blue);
      cursor: pointer;
    }
    .info-btn:hover { background: #e2efff; }

    .info-box {
      margin-top: var(--space-3);
      border: 1px dashed var(--border);
      border-radius: var(--radius-md);
      padding: var(--space-4);
      background: var(--off-white);
      color: var(--near-black);
    }
    .info-box ul { list-style: disc inside; }

    /* Optional strength meter (visual only; no JS logic) */
    .strength {
      display: grid; grid-template-columns: repeat(4, 1fr); gap: 6px;
      margin-top: var(--space-3);
    }
    .strength span {
      height: 8px; border-radius: 999px;
      background: #e6ecf3;
    }
    .strength--weak span:nth-child(-n+1) { background: #ffd9d6; }     /* red tint */
    .strength--ok   span:nth-child(-n+2) { background: #ffe7c6; }     /* amber tint */
    .strength--good span:nth-child(-n+3) { background: #dff2e8; }     /* green tint */
    .strength--strong span { background: #c9e8d8; }

    /* ---------- Actions ---------- */
    .form-actions {
      display: flex; flex-wrap: wrap; gap: var(--space-3);
      align-items: center; margin-top: var(--space-4);
    }

    .btn {
      display: inline-flex; align-items: center; justify-content: center; gap: 8px;
      font-weight: 600; border-radius: 999px; cursor: pointer;
      border: 1px solid transparent;
      transition: transform 120ms ease, box-shadow 120ms ease, background 120ms ease, border-color 120ms ease, color 120ms ease;
      padding: 10px 16px;
    }
    .btn--primary {
      background: linear-gradient(180deg, var(--logo-blue), #2b6ca3);
      color: var(--white); border-color: #2b6ca3;
    }
    .btn--primary:hover {
      background: linear-gradient(180deg, #3a86c8, var(--logo-blue));
      box-shadow: var(--shadow-md); transform: translateY(-1px);
    }
    .btn--primary:active { transform: translateY(0); }

    .btn--secondary {
      background: var(--burgundy); color: var(--white); border-color: #5b1919;
    }
    .btn--secondary:hover {
      background: #5b1919; box-shadow: var(--shadow-md); transform: translateY(-1px);
    }
    .btn--secondary:active { transform: translateY(0); }

    /* ---------- Alerts ---------- */
    .alert {
      border: 1px solid var(--border);
      border-radius: var(--radius-md);
      padding: var(--space-5);
      margin-top: var(--space-6);
      display: grid; gap: var(--space-2);
      min-height: 48px;
    }
    .alert--success {
      background: #EBFAF0; border-color: #CFEBD7; color: var(--forest-deep);
    }
    .alert--error {
      background: #FDECEA; border-color: #F5C5C4; color: var(--burgundy);
    }

    /* ---------- Footer ---------- */
    .page-footer {
      border-top: 1px solid var(--border);
      background: var(--off-white);
      color: var(--muted-text);
      padding: var(--space-6) var(--space-8);
    }
    .page-footer__links a { color: var(--logo-blue); }
    .page-footer__meta { margin-top: var(--space-3); font-size: .95rem; }

    /* ---------- Success panel spacing ---------- */
    #success .form-actions { margin-top: var(--space-3); }

    /* ---------- Responsive ---------- */
    @media (max-width: 768px) {
      .layout { padding: var(--space-6); }
      .btn { width: 100%; } /* easier taps on mobile */
    }

    /* ---------- Print ---------- */
    @media print {
      .app-header, .page-footer { display: none; }
      .layout { padding: 0; }
      .panel { box-shadow: none; border-color: #ccc; }
      .btn { display: none; }
    }
  </style>
</head>
<body>
  <div class="app" role="application" aria-label="Reset Password">
    <!-- Header -->
    <header class="app-header">
      <div class="brand">
        <h1 class="brand__title">MediSync</h1>
        <p class="brand__subtitle">Reset Password</p>
      </div>
    </header>

    <!-- Main Layout -->
    <div class="layout">
      <main class="content">
        <!-- Reset form panel -->
        <section class="panel reset-password" id="resetPanel">
          <h2 class="panel__title">Set a new password</h2>
          <p class="panel__description">Enter and confirm your new password.</p>


            <div class="form-field password-field">
            <label for="newPassword" class="form-field__label">
                New Password: 
                <!-- Info icon
                <button type="button" class="info-btn" aria-label="Password guidelines">i</button> -->
            </label>
            <input
                type="password"
                id="newPassword"
                name="newPassword"
                class="form-field__input"
                required
                minlength="8"
                placeholder="New password"
            />

            <!-- Hidden guidelines box -->
            <div class="info-box" hidden>
                <p>Password should:</p>
                <ul>
                <li>Be at least 8 characters long</li>
                <li>Include uppercase and lowercase letters</li>
                <li>Contain numbers and special characters</li>
                </ul>
            </div>
            </div>


            <!-- Confirm Password -->
            <div class="form-field">
              <label for="confirmPassword" class="form-field__label">Confirm Password: </label>
              <input
                type="password"
                id="confirmPassword"
                name="confirmPassword"
                class="form-field__input"
                required
                minlength="8"
                placeholder="Re-enter new password"
              />
              <p class="form-field__help">Both fields must match.</p>
            </div>

            <!-- Actions -->
            <div class="form-actions">
              <button type="submit" class="btn btn--primary">Reset Password</button>
              <button type="submit" class="btn btn--primary">Cancel</button>
            </div>

            <!-- Error placeholder (for styling; shown by backend/JS later) -->
            <div class="alert alert--error" role="alert" aria-live="polite">
              <!-- Password policy or mismatch messages go here -->
            </div>
          </form>
        </section>

        <!-- Success acknowledgement (same page anchor target)
        <section id="success" class="panel" aria-live="polite" role="status">
          <h2 class="panel__title">Password changed successfully</h2>
          <p class="panel__description">You can now sign in with your new password.</p>
          <div class="form-actions">
          </div>
        </section>
      </main>
    </div> -->
    <hr>
    <!-- Footer -->
    <footer class="page-footer">
      <nav class="page-footer__links" aria-label="Legal">
        <a href="#">Privacy</a> •
        <a href="#">Terms</a> •
        <a href="#">Help Center</a>
      </nav>
      <p class="page-footer__meta">
        © 2025 MediSync · Contact:
        xxxxxxxxxx</a> /
        mailto:<a href ="#">somethingmail@mail.com</a>
      </p>
    </footer>
  </div>
  
<script>
  /**
   * MediSync – Reset Password Page Script
   * Validation, strength meter, toggles, accessibility, and responsiveness.
   */
  (function () {
    "use strict";

    /* ===========================
      Utilities
      =========================== */
    const qs  = (sel, root = document) => root.querySelector(sel);
    const qsa = (sel, root = document) => Array.from(root.querySelectorAll(sel));
    const on  = (el, ev, handler, opts) => el && el.addEventListener(ev, handler, opts);
    const debounce = (fn, wait = 160) => { let t; return (...args) => { clearTimeout(t); t = setTimeout(() => fn(...args), wait); }; };

    /* ===========================
      DOM references
      =========================== */
    const newPw        = qs("#newPassword");
    const confirmPw    = qs("#confirmPassword");
    const errorBox     = qs(".alert.alert--error");
    const resetBtn     = qsa(".form-actions .btn").find(b => /reset/i.test(b.textContent));
    const cancelBtn    = qsa(".form-actions .btn").find(b => /cancel/i.test(b.textContent));
    const infoBox      = qs(".info-box");
    const panelTitle   = qs(".reset-password .panel__title");

    /* ===========================
      Inline helper styles (for strength meter & small UI)
      =========================== */
    (function injectInlineStyles() {
      const style = document.createElement("style");
      style.textContent = `
        .alert[hidden] { display: none !important; }
        .pw-tools { display: flex; gap: 8px; margin-top: 8px; flex-wrap: wrap; }
        .btn--ghost { background: #ecf5ff; color: #1F3A4D; border: 1px solid #337AB7; border-radius: 999px; padding: 6px 10px; cursor: pointer; }
        .btn--ghost:hover { background: #e2efff; }
        .strength { display: grid; grid-template-columns: repeat(4, 1fr); gap: 6px; margin-top: 8px; }
        .strength span { height: 8px; border-radius: 999px; background: #e6ecf3; }
        .strength--weak   span:nth-child(-n+1) { background: #ffd9d6; }
        .strength--ok     span:nth-child(-n+2) { background: #ffe7c6; }
        .strength--good   span:nth-child(-n+3) { background: #dff2e8; }
        .strength--strong span { background: #c9e8d8; }
        .strength-label { font-size: 0.9rem; color: #515151; margin-top: 6px; }
      `;
      document.head.appendChild(style);
    })();

    /* ===========================
      Error messaging
      =========================== */
    function showError(msgs) {
      if (!errorBox) return;
      if (!msgs || msgs.length === 0) {
        errorBox.hidden = true;
        errorBox.innerHTML = "";
        return;
      }
      errorBox.hidden = false;
      errorBox.innerHTML = "<ul>" + msgs.map(m => `<li>${m}</li>`).join("") + "</ul>";
      errorBox.setAttribute("aria-live", "polite");
      // Focus first invalid field on the next tick
      setTimeout(focusFirstInvalid, 50);
    }

    function focusFirstInvalid() {
      const firstInvalid = [newPw, confirmPw].find(el => el && el.getAttribute("aria-invalid") === "true");
      if (firstInvalid) firstInvalid.focus();
    }

    /* ===========================
      Password policy & strength
      =========================== */
    const reUpper = /[A-Z]/;
    const reLower = /[a-z]/;
    const reDigit = /\d/;
    const reSpec  = /[^A-Za-z0-9]/;

    function policyChecks(val) {
      const msgs = [];
      if (!val || val.length < 8) msgs.push("Password must be at least 8 characters.");
      if (!reUpper.test(val))     msgs.push("Include at least one uppercase letter.");
      if (!reLower.test(val))     msgs.push("Include at least one lowercase letter.");
      if (!reDigit.test(val))     msgs.push("Include at least one number.");
      if (!reSpec.test(val))      msgs.push("Include at least one special character.");
      if (/\s/.test(val))         msgs.push("Password must not contain spaces.");
      return msgs;
    }

    function scoreStrength(val) {
      let score = 0;
      if (!val) return 0;
      if (val.length >= 8)  score++;
      if (val.length >= 12) score++; // length bonus
      if (reUpper.test(val)) score++;
      if (reLower.test(val)) score++;
      if (reDigit.test(val)) score++;
      if (reSpec.test(val))  score++;
      // Normalize to 0..4
      return Math.min(4, Math.floor(score / 2));
    }

    let strengthEl = null;
    let strengthLabelEl = null;

    function ensureStrengthUI() {
      if (!newPw) return;
      if (!strengthEl) {
        strengthEl = document.createElement("div");
        strengthEl.className = "strength";
        strengthEl.innerHTML = "<span></span><span></span><span></span><span></span>";
        newPw.insertAdjacentElement("afterend", strengthEl);
      }
      if (!strengthLabelEl) {
        strengthLabelEl = document.createElement("div");
        strengthLabelEl.className = "strength-label";
        strengthEl.insertAdjacentElement("afterend", strengthLabelEl);
      }
    }

    function updateStrength(val) {
      ensureStrengthUI();
      const s = scoreStrength(val);
      strengthEl.classList.remove("strength--weak","strength--ok","strength--good","strength--strong");
      strengthLabelEl.textContent = ["Very weak", "Weak", "Okay", "Good", "Strong"][s] || "Very weak";
      strengthEl.classList.add(["strength--weak","strength--weak","strength--ok","strength--good","strength--strong"][s] || "strength--weak");
    }

    /* ===========================
      Validation
      =========================== */
    function validateNew() {
      const v = (newPw?.value || "").trim();
      const msgs = policyChecks(v);
      newPw && newPw.setAttribute("aria-invalid", String(Boolean(msgs.length)));
      return msgs;
    }

    function validateConfirm() {
      const v1 = (newPw?.value || "").trim();
      const v2 = (confirmPw?.value || "").trim();
      const msgs = [];
      if (!v2) msgs.push("Confirm your password.");
      else if (v1 !== v2) msgs.push("Passwords do not match.");
      confirmPw && confirmPw.setAttribute("aria-invalid", String(Boolean(msgs.length)));
      return msgs;
    }

    function validateAll() {
      const msgs = [];
      msgs.push(...validateNew());
      msgs.push(...validateConfirm());
      showError(msgs);
      return msgs.length === 0;
    }

    /* ===========================
      Toggles: show/hide & info
      =========================== */
    function injectPwTools() {
      const attachTools = (input, withInfoButton = false) => {
        if (!input) return;
        const container = document.createElement("div");
        container.className = "pw-tools";

        const toggleBtn = document.createElement("button");
        toggleBtn.type = "button";
        toggleBtn.className = "btn--ghost";
        toggleBtn.setAttribute("aria-pressed", "false");
        toggleBtn.textContent = "Show password";
        on(toggleBtn, "click", () => {
          const isText = input.type === "text";
          input.type = isText ? "password" : "text";
          toggleBtn.setAttribute("aria-pressed", String(!isText));
          toggleBtn.textContent = isText ? "Show password" : "Hide password";
          input.focus();
        });

        container.appendChild(toggleBtn);

        if (withInfoButton && infoBox) {
          const infoBtn = document.createElement("button");
          infoBtn.type = "button";
          infoBtn.className = "btn--ghost";
          infoBtn.textContent = "Password guidelines";
          infoBtn.setAttribute("aria-expanded", String(!infoBox.hasAttribute("hidden")));
          on(infoBtn, "click", () => {
            const isHidden = infoBox.hasAttribute("hidden");
            if (isHidden) infoBox.removeAttribute("hidden"); else infoBox.setAttribute("hidden", "");
            infoBtn.setAttribute("aria-expanded", String(isHidden));
          });
          container.appendChild(infoBtn);
        }

        input.insertAdjacentElement("afterend", container);
      };

      // new password gets info toggle
      attachTools(newPw, true);
      // confirm password gets show/hide only
      attachTools(confirmPw, false);
    }

    /* ===========================
      Submit & Cancel behavior
      =========================== */
    function submitReset() {
      showError([]);
      const ok = validateAll();
      if (!ok) return;

      // Simulate success and redirect to "Password Changed" page
      // Replace with your real backend call
      setTimeout(() => { window.location.href = "ps_reset_success.html"; }, 600);
    }

    function cancelFlow() {
      // Prevent accidental submit & go back
      if (history.length > 1) history.back();
      else window.location.href = "login.html";
    }

    /* ===========================
      Live validation & shortcuts
      =========================== */
    function initLiveValidation() {
      on(newPw, "input", debounce(() => { updateStrength(newPw.value); validateNew(); }));
      on(confirmPw, "input", debounce(() => validateConfirm()));

      [newPw, confirmPw].forEach((inp) => {
        on(inp, "keydown", (e) => {
          if (e.key === "Enter") { e.preventDefault(); submitReset(); }
          if (e.key === "Escape") { inp.value = ""; inp.dispatchEvent(new Event("input", { bubbles: true })); }
          // Ctrl/⌘+I toggles info
          if ((e.ctrlKey || e.metaKey) && e.key.toLowerCase() === "i" && infoBox) {
            e.preventDefault();
            const isHidden = infoBox.hasAttribute("hidden");
            if (isHidden) infoBox.removeAttribute("hidden"); else infoBox.setAttribute("hidden", "");
          }
          // Ctrl/⌘+H toggles show/hide
          if ((e.ctrlKey || e.metaKey) && e.key.toLowerCase() === "h") {
            e.preventDefault();
            inp.type = inp.type === "text" ? "password" : "text";
          }
        });
      });
    }

    /* ===========================
      Responsive behavior
      =========================== */
    const mq = window.matchMedia("(max-width: 768px)");
    function applyResponsive(mql) {
      newPw && newPw.setAttribute("aria-label", mql.matches ? "New password" : "Enter new password");
      confirmPw && confirmPw.setAttribute("aria-label", mql.matches ? "Confirm password" : "Re-enter new password to confirm");
    }

    /* ===========================
      Init
      =========================== */
    on(document, "DOMContentLoaded", () => {
      // Focus the first field
      newPw && newPw.focus();

      // Ensure alerts start hidden
      if (errorBox) errorBox.hidden = true;

      // Inject tools (show/hide & info)
      injectPwTools();

      // Strength meter
      updateStrength(newPw?.value || "");

      // Button handlers
      on(resetBtn, "click", (e) => { e.preventDefault(); submitReset(); });
      on(cancelBtn, "click", (e) => { e.preventDefault(); cancelFlow(); });

      // Live validation
      initLiveValidation();

      // Responsive
      applyResponsive(mq);
      on(mq, "change", applyResponsive);

      // Accessibility: focus title for screen readers
      if (panelTitle) { panelTitle.setAttribute("tabindex", "-1"); panelTitle.focus(); }
    });
  })();
</script>

<script>
(() => {
  // Demo defaults
  const DEMO_DEFAULTS = {
    email: "demo.user@example.com",
    password: "OldPass@123" // initial password for first login
  };

  // Ensure defaults exist once per session
  if (!sessionStorage.getItem("demo_email")) {
    sessionStorage.setItem("demo_email", DEMO_DEFAULTS.email);
  }
  if (!sessionStorage.getItem("demo_password")) {
    sessionStorage.setItem("demo_password", DEMO_DEFAULTS.password);
  }

  const newPwEl = document.getElementById("newPassword");
  const confirmPwEl = document.getElementById("confirmPassword");
  const form = document.querySelector("form");
  const errorBox = document.getElementById("errorBox"); // optional

  function showError(msg) {
    if (errorBox) {
      errorBox.textContent = msg;
      errorBox.style.display = "block";
    } else {
      alert(msg);
    }
  }
  function clearError() {
    if (errorBox) {
      errorBox.textContent = "";
      errorBox.style.display = "none";
    }
  }

  if (!form || !newPwEl || !confirmPwEl) return;

  form.addEventListener("submit", (e) => {
    e.preventDefault();
    clearError();

    const newPw = (newPwEl.value || "").trim();
    const confirmPw = (confirmPwEl.value || "").trim();
    document.getElementById("confirmPassword").value.trim();

    if (!newPw || !confirmPw) return showError("Both password fields are required.");
    if (newPw.length < 6) return showError("Password must be at least 6 characters."); // demo rule
    if (newPw !== confirmPw) return showError("Passwords do not match.");

    // ✅ Store the NEW password for this session
    sessionStorage.setItem("demo_password", newPw);

    // Redirect to success page
    
// after validations + saving password
  window.location.assign("ps_reset_success.html");

  });
})();
</script>


</body>
</html>
