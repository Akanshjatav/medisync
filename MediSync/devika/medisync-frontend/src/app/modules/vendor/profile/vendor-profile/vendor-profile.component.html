<div class="page vendor-shell" role="application" aria-label="Vendor Profile">
  <!-- SIDEBAR -->
  <aside
    class="sidebar"
    id="vendorSidebar"
    [class.open]="sidebarOpen"
    aria-label="Vendor navigation"
  >
    <div class="side-card">
      <div class="side-title">Vendor</div>

      <nav class="nav vendor-nav" aria-label="Vendor sections">
        <a
          routerLink="/dashboard"
          routerLinkActive="active"
          [routerLinkActiveOptions]="{ exact: true }"
          (click)="closeSidebar()"
        >
          Dashboard <span class="badge"></span>
        </a>

        <a
          routerLink="/active-rfqs"
          routerLinkActive="active"
          (click)="closeSidebar()"
        >
          Active RFQs <span class="badge"></span>
        </a>

        <a
          routerLink="/vendor-profile"
          routerLinkActive="active"
          [routerLinkActiveOptions]="{ exact: true }"
          (click)="closeSidebar()"
        >
          Profile <span class="badge"></span>
        </a>
      </nav>
    </div>
  </aside>

  <!-- BACKDROP (for mobile overlay sidebar) -->
  <div
    class="backdrop"
    [class.open]="sidebarOpen"
    aria-hidden="true"
    (click)="closeSidebar()"
  ></div>

  <!-- MAIN CONTENT -->
  <main class="main" role="main" aria-label="Vendor profile content">
    <div class="wrap">

      <!-- ✅ NEW: Search bar centered below header -->
      <section class="rfq-search-wrap" aria-label="Search Active RFQs">
        <form
          class="rfq-search"
          role="search"
          (submit)="$event.preventDefault(); onRfqSearch(rfqSearch.value)"
        >
          <input
            #rfqSearch
            class="rfq-input"
            type="search"
            placeholder="Search for active RFQs"
            autocomplete="off"
            aria-label="Search for active RFQs"
          />
          <button class="rfq-btn" type="submit" aria-label="Search">
            Search
          </button>
        </form>
      </section>

      <!-- TOP BAR: hamburger + title/actions -->
      <div class="page-title">
        <div class="title-left">
          <button
            class="hamburger"
            type="button"
            aria-label="Toggle sidebar"
            [attr.aria-expanded]="sidebarOpen"
            aria-controls="vendorSidebar"
            (click)="toggleSidebar()"
          >
            ☰ <span style="font-weight: 900;">Menu</span>
          </button>

          <div>
            <h2>Vendor Profile</h2>
            <p>Your vendor information is shown below. Use Edit to make changes.</p>
          </div>
        </div>

        <div class="top-actions">
          <button *ngIf="!editMode" type="button" class="btn" (click)="onEdit()">Edit</button>
          <button *ngIf="editMode" type="button" class="xbtn" (click)="onCancel()">Cancel</button>
          <button *ngIf="editMode" type="button" class="btn" (click)="onSave()">Save</button>
        </div>
      </div>

      <section class="grid single" aria-label="Vendor profile section">
        <div class="card">

          <div class="profile-head">
            <div>
              <h3 class="profile-title">{{ vendor.companyName || 'Company name' }}</h3>
              <p class="sub" style="margin-top: 6px;">
                Vendor ID: <strong>{{ vendor.vendorId || '—' }}</strong>
                <span class="dot">•</span>
                User ID: <strong>{{ vendor.userId || '—' }}</strong>
              </p>
            </div>
          </div>

          <div class="divider"></div>

          <div class="alert" *ngIf="loading" role="status" aria-live="polite">
            Loading vendor profile...
          </div>

          <!-- VIEW MODE -->
          <div *ngIf="!editMode && !loading" class="kv">
            <div class="kv-row">
              <div class="kv-label">Vendor ID:</div>
              <div class="kv-value">{{ vendor.vendorId }}</div>
            </div>

            <div class="kv-row">
              <div class="kv-label">User ID:</div>
              <div class="kv-value">{{ vendor.userId }}</div>
            </div>

            <div class="kv-row">
              <div class="kv-label">Company Name:</div>
              <div class="kv-value">{{ vendor.companyName }}</div>
            </div>

            <div class="kv-row">
              <div class="kv-label">GST Number:</div>
              <div class="kv-value">{{ vendor.gstNumber }}</div>
            </div>

            <div class="kv-row">
              <div class="kv-label">License Number:</div>
              <div class="kv-value">{{ vendor.licenseNumber }}</div>
            </div>

            <div class="kv-row">
              <div class="kv-label">Address:</div>
              <div class="kv-value prewrap">{{ vendor.address }}</div>
            </div>

            <div class="kv-row">
              <div class="kv-label">Status:</div>
              <div class="kv-value">{{ vendor.status }}</div>
            </div>
          </div>

          <!-- EDIT MODE -->
          <form *ngIf="editMode" class="form" [formGroup]="form" (ngSubmit)="onSave()" novalidate>
            <div class="row-2">
              <div class="action">
                <h4>Vendor ID</h4>
                <input type="text" formControlName="vendorId" />
              </div>

              <div class="action">
                <h4>User ID</h4>
                <input type="text" formControlName="userId" />
              </div>
            </div>

            <div class="action">
              <h4>Company Name</h4>
              <input type="text" formControlName="companyName" />
            </div>

            <div class="row-2">
              <div class="action">
                <h4>GST Number</h4>
                <input type="text" formControlName="gstNumber" />
              </div>

              <div class="action">
                <h4>License Number</h4>
                <input type="text" formControlName="licenseNumber" />
              </div>
            </div>

            <div class="action">
              <h4>Address</h4>
              <textarea rows="4" formControlName="address"></textarea>
            </div>

            <div class="action">
              <h4>Status</h4>
              <select formControlName="status">
                <option value="Verified">Verified</option>
                <option value="Unverified">Unverified</option>
              </select>
            </div>

            <div class="form-actions">
              <button type="button" class="xbtn" (click)="onCancel()">Cancel</button>
              <button type="submit" class="btn">Save</button>
            </div>
          </form>

          <div class="alert success" *ngIf="successMessage" role="status" aria-live="polite">
            {{ successMessage }}
          </div>

          <div class="alert" *ngIf="errorMessages.length" role="alert" aria-live="polite">
            <ul>
              <li *ngFor="let msg of errorMessages">{{ msg }}</li>
            </ul>
          </div>

        </div>
      </section>

    </div>
  </main>
</div>